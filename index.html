<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="LightsOut: Diffusion-based Outpainting for Enhanced Lens Flare Removal.">
  <meta name="keywords" content="LightsOut, Lens Flare Removal, Outpainting, Diffusion Model">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LightsOut</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- <link rel="stylesheet" href="./static/css/bootstrap.min.css"> -->
  <!-- <link rel="stylesheet" href="./static/css/app.css"> -->
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="./static/js/video_comparison.js"></script>
  <script src="./static/js/app.js"></script>
</head>

<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title neon-text">LightsOut <img src="static/images/favicon.svg" alt="icon"
                style="height: 1em; "></h1>
            <h2 class="subtitle is-3 publication-subtitle"><strong>Diffusion-based Outpainting for Enhanced Lens Flare
                Removal</strong></h2>
            <h3 class="subtitle is-3 publication-subtitle"><strong>ICCV 2025</strong></h3>
            <div class="is-size-4 publication-authors">
              <span class="author-block">
                <a href="">Shr-Ruei Tsai</a>,</span>
              <span class="author-block">
                <a href="">Wei-Cheng Chang</a>,</span>
              <span class="author-block">
                <a href="https://jayinnn.dev/">Jie-Ying Lee</a>,</span>
              <span class="author-block">
                <a href="https://su-terry.github.io/">Chih-Hai Su</a>,</span>
              <span class="author-block">
                <a href="https://yulunalexliu.github.io/">Yu-Lun Liu</a></span>
            </div>

            <div class="is-size-4 publication-authors">
              <span class="author-block">National Yang Ming Chiao Tung University</span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <!-- <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span> -->
                <span class="link-block">
                  <a href="" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- Video Link. -->
                <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
                <!-- Code Link. -->
                <span class="link-block">
                  <a href="https://github.com/Ray-1026/LightsOut-official"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
                <!-- Dataset Google Drive Link. -->
                <!-- <span class="link-block"> -->
                <!-- <a href="https://drive.google.com/drive/folders/1C0OqUSavUBwR_p_yNRBia90jvC-23hNN?usp=sharing"
                    class="external-link button is-normal is-rounded is-dark"> -->
                <!-- <span class="icon"> -->
                <!-- <img src="https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png" width="20"
                        height="20" alt="Google Drive"> -->
                <!-- </span> -->
                <!-- <span>Data (Google Drive)</span> -->
                <!-- </a> -->
                <!-- </span> -->
                <!-- Dataset HF Link. -->
                <!-- <span class="link-block"> -->
                <!-- <a href="https://huggingface.co/datasets/kkennethwu/360-USID"
                    class="external-link button is-normal is-rounded is-dark"> -->
                <!-- <span class="icon"> -->
                <!-- <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" width="20"
                        height="20" alt="HF"> -->
                <!-- </span> -->
                <!-- <span>Data (HF)</span> -->
                <!-- </a> -->
                <!-- </span> -->
                <!-- Results Link. -->
                <!-- <span class="link-block"> -->
                <!-- <a href="https://drive.google.com/drive/folders/1ujTKiBfTBD_BVv9YiifOl_SfG8sd0dZ6?usp=sharing"
                    class="external-link button is-normal is-rounded is-dark"> -->
                <!-- <span class="icon"> -->
                <!-- <i class="far fa-images"></i> -->
                <!-- </span> -->
                <!-- <span>Evaluation Results</span> -->
                <!-- </a> -->
                <!-- </span> -->
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <div class="pipeline-figure">
          <img src="./static/images/teaser.png" alt="Teaser" style="width: 100%;" />
        </div>
        <h2 class="subtitle is-3 has-text-centered">
          <!-- <span class="dnerf">AuraFusion360</span> can do inpainting in the 360Â° unbounded scene. -->
          <span class="subtitle is-3 neon-text">LightsOut</span> ...
        </h2>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">

      <!-- Video. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Video</h2>
          <div class="video-container"
            style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; border-radius: 12px;">
            <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 12px;" src=""
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen></iframe>
          </div>
        </div>
      </div>

      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Lens flare significantly degrades image quality, impacting critical computer vision tasks like object
              detection and autonomous driving. Recent Single Image Flare Removal (SIFR) methods perform poorly when
              off-frame light sources are incomplete or absent. We propose LightsOut, a diffusion-based outpainting
              framework tailored to enhance SIFR by reconstructing off-frame light sources. Our method leverages a
              multitask regression module and LoRA fine-tuned diffusion model to ensure realistic and physically
              consistent outpainting results. Comprehensive experiments demonstrate LightsOut consistently boosts the
              performance of existing SIFR methods across challenging scenarios without additional retraining, serving
              as a universally applicable plug-and-play preprocessing solution.
            </p>
          </div>
        </div>
      </div>
      <!--/ Abstract. -->

      <!-- Pipeline Fig. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Approach</h2>
          <div class="pipeline-figure">
            <img src="./static/images/pipeline.png" alt="Pipeline" style="width: 95%;" />
          </div>
          <div class="content has-text-justified">
            <p>
              (a) <strong>Light source prediction and conditioning</strong>: We introduce a multitask regression module
              to accurately predict off-frame or incomplete light source parameters (positions, radii, and confidences).
              These predicted parameters guide a rendering function to generate the corresponding light source mask. (b)
              <strong>Light source outpainting</strong>: Leveraging a LoRA fine-tuned diffusion-based inpainting model
              with light source conditioning, our approach accurately outpaints both missing off-frame light sources and
              associated flare artifacts, producing visually coherent and realistic results. (c) <strong>SIFR
                boosting</strong>: Our generated outpainted images serve as enhanced inputs to existing SIFR methods,
              significantly improving their performance on previously challenging scenarios with incomplete light source
              information. The proposed pipeline thus effectively operates as a plug-and-play module to boost existing
              flare removal models.
            </p>
          </div>
        </div>
      </div>
      <!--/ Pipeline Fig. -->

    </div>
  </section>




  <section class="section">
    <div class="container is-max-desktop">
      <!-- Animation. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Visualization Results</h2>
        </div>
      </div>
      <!--/ Animation. -->


      <!-- Concurrent Work. -->
      <!-- <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Related Links</h2>

        <div class="content has-text-justified">
          <p>
            There's a lot of excellent work that was introduced around the same time as ours.
          </p>
          <p>
            <a href="https://arxiv.org/abs/2104.09125">Progressive Encoding for Neural Optimization</a> introduces an idea similar to our windowed position encoding for coarse-to-fine optimization.
          </p>
          <p>
            <a href="https://www.albertpumarola.com/research/D-NeRF/index.html">D-NeRF</a> and <a href="https://gvv.mpi-inf.mpg.de/projects/nonrigid_nerf/">NR-NeRF</a>
            both use deformation fields to model non-rigid scenes.
          </p>
          <p>
            Some works model videos with a NeRF by directly modulating the density, such as <a href="https://video-nerf.github.io/">Video-NeRF</a>, <a href="https://www.cs.cornell.edu/~zl548/NSFF/">NSFF</a>, and <a href="https://neural-3d-video.github.io/">DyNeRF</a>
          </p>
          <p>
            There are probably many more by the time you are reading this. Check out <a href="https://dellaert.github.io/NeRF/">Frank Dellart's survey on recent NeRF papers</a>, and <a href="https://github.com/yenchenlin/awesome-NeRF">Yen-Chen Lin's curated list of NeRF papers</a>.
          </p>
        </div>
      </div>
    </div> -->
      <!--/ Concurrent Work. -->

      <div class="columns is-centered">
        <div class="column is-full-width">

          <!-- <h3 id="title-text" class="subtitle is-4" style="text-align: center;"> -->
          <!-- AuraFusion360 outperforms other methods in unbounded 360Â° scene inpainting. -->
          <!-- </h3> -->

          <div class="text-center ">
            <ul class="nav nav-pills center-pills">
              <li class="method-pill active" data-value="gscream" onclick="selectCompVideo(this, activeScenePill)">
                <a>GScream</a>
              </li>
              <li class="method-pill" data-value="gaussiangrouping" onclick="selectCompVideo(this, activeScenePill)">
                <a>GaussianGrouping</a>
              </li>
              <li class="method-pill" data-value="infusion" onclick="selectCompVideo(this, activeScenePill)">
                <a>InFusion</a>
              </li>
              <li class="method-pill" data-value="2dgsleftrefill" onclick="selectCompVideo(this, activeScenePill)">
                <a>2DGS+LeftRefill</a>
              </li>
              <li class="method-pill" data-value="spin" onclick="selectCompVideo(this, activeScenePill)">
                <a>SPin-NeRF*</a>
              </li>

              <li class="method-pill" data-value="poisson" onclick="selectCompVideo(this, activeScenePill)">
                <a>Poisson</a>
              </li>
              <li class="method-pill" data-value="gdd" onclick="selectCompVideo(this, activeScenePill)"><a>Guided Depth
                  Diffusion</a></li>
              <li class="method-pill" data-value="scaleshift" onclick="selectCompVideo(this, activeScenePill)"><a>Scale
                  & Shift</a></li>
            </ul>
            <!-- <ul class="nav nav-pills center-pills">
                  <li class="method-pill" data-value="freenerf"
                      onclick="selectCompVideo(this, activeScenePill)"><a>FreeNeRF</a></li>
                  <li class="method-pill" data-value="simplenerf"
                      onclick="selectCompVideo(this, activeScenePill)"><a>SimpleNeRF</a></li>
                  <li class="method-pill" data-value="zeronvs"
                      onclick="selectCompVideo(this, activeScenePill)"><a>ZeroNVS</a></li>
              </ul> -->
          </div>

          <script>
            activeMethodPill = document.querySelector('.method-pill.active-pill');
            activeScenePill = document.querySelector('.scene-pill.active-pill');
            activeModePill = document.querySelector('.mode-pill.active-pill');

            updateMethodVisibility('rgb')
          </script>

          <div class="text-center">
            <div class="video-container">
              <video class="video" style="height: 280px; max-width: 100%;" m id="compVideo0" loop playsinline autoplay
                muted>
                <source src="./videos/comparison/360USID_carton_gscream_vs_ours_rgb.mp4" />
              </video>
              <video class="video" style="height: 280px; max-width: 100%;" id="compVideo1" loop playsinline autoplay
                muted hidden>
                <source src="./videos/comparison/360USID_carton_gscream_vs_ours_rgb.mp4" />
              </video>
            </div>


            <div class="text-center" style="color: black;" id="mode-pills">
              <div class="btn-group btn-group-sm">
                <span class="btn btn-primary mode-pill active" data-value="rgb"
                  onclick="updateMethodVisibility('rgb'); selectCompVideo(activeMethodPill, activeScenePill, null, this)">
                  Inpainting Results
                </span>
                <span class="btn btn-primary mode-pill" data-value="mask"
                  onclick="updateMethodVisibility('mask'); selectCompVideo(activeMethodPill, activeScenePill, null, this)">
                  Unseen Mask
                </span>
                <span class="btn btn-primary mode-pill" data-value="depth"
                  onclick="updateMethodVisibility('depth'); selectCompVideo(activeMethodPill, activeScenePill, null, this)">
                  Depth Initilaized Points
                </span>
              </div>
            </div>


            <br>
            <p class="text-justify" style="text-align: center; display: none;">
              Baseline method (left) vs AuraFusion360 (right). Scene trained on <span id="compVideoValue">3</span>
              views. Try selecting different methods and scenes!
            </p>
            <p class="text-justify" style="text-align: center;">
              <span id="description-text">3</span> Try selecting different methods and scenes!
            </p>
            <script>
              video0 = document.getElementById("compVideo0");
              video1 = document.getElementById("compVideo1");
              video0.addEventListener('loadedmetadata', function () {
                if (activeVidID == 0 && select) {
                  video0.play();
                  // print video size
                  console.log(video0.videoWidth, video0.videoHeight);
                  video0.hidden = false;
                  video1.hidden = true;
                }
              });
              video1.addEventListener('loadedmetadata', function () {
                if (activeVidID == 1 && select) {
                  video1.play();
                  // print video size
                  console.log(video1.videoWidth, video1.videoHeight);
                  video0.hidden = true;
                  video1.hidden = false;
                }
              });
            </script>

            <div class="pill-row scene-pills" id="scene-pills">
              <span class="pill scene-pill active" data-value="360USID_carton"
                onclick="selectCompVideo(activeMethodPill, this, 3)">
                <img class="thumbnail-img" src="thumbnails/360USID_carton_thumbnail.png" alt="360USID/carton"
                  width="64">
              </span>
              <span class="pill scene-pill" data-value="360USID_cone"
                onclick="selectCompVideo(activeMethodPill, this, 3)">
                <img class="thumbnail-img" src="thumbnails/360USID_cone_thumbnail.png" alt="360USID/cone" width="64">
              </span>
              <span class="pill scene-pill" data-value="360USID_skateboard"
                onclick="selectCompVideo(activeMethodPill, this, 3)">
                <img class="thumbnail-img" src="thumbnails/360USID_skateboard_thumbnail.png" alt="360USID/skateboard"
                  width="64">
              </span>
              <span class="pill scene-pill" data-value="360USID_newcone"
                onclick="selectCompVideo(activeMethodPill, this, 3)">
                <img class="thumbnail-img" src="thumbnails/360USID_newcone_thumbnail.png" alt="360USID/newcone"
                  width="64">
              </span>
              <span class="pill scene-pill" data-value="360USID_sunflower"
                onclick="selectCompVideo(activeMethodPill, this, 3)">
                <img class="thumbnail-img" src="thumbnails/360USID_sunflower_thumbnail.png" alt="360USID/sunflower"
                  width="64">
              </span>
              <span class="pill scene-pill" data-value="360USID_plant"
                onclick="selectCompVideo(activeMethodPill, this, 3)">
                <img class="thumbnail-img" src="thumbnails/360USID_plant_thumbnail.png" alt="360USID/plant" width="64">
              </span>
              <span class="pill scene-pill" data-value="360USID_cookie"
                onclick="selectCompVideo(activeMethodPill, this, 6)">
                <img class="thumbnail-img" src="thumbnails/360USID_cookie_thumbnail.png" alt="360USID/cookie"
                  width="64">
              </span>
              <br>

              <span class="pill scene-pill" data-value="Other360_kitchen"
                onclick="selectCompVideo(activeMethodPill, this, 6)">
                <img class="thumbnail-img" src="thumbnails/Other360_kitchen_thumbnail.png" alt="Other360/kitchen"
                  width="64">
              </span>
              <span class="pill scene-pill" data-value="Other360_bear"
                onclick="selectCompVideo(activeMethodPill, this, 6)">
                <img class="thumbnail-img" src="thumbnails/Other360_bear_thumbnail.png" alt="Other360/bear" width="64">
              </span>
              <span class="pill scene-pill" data-value="Other360_bonsai"
                onclick="selectCompVideo(activeMethodPill, this, 6)">
                <img class="thumbnail-img" src="thumbnails/Other360_bonsai_thumbnail.png" alt="Other360/bonsai"
                  width="64">
              </span>
              <span class="pill scene-pill" data-value="Other360_room"
                onclick="selectCompVideo(activeMethodPill, this, 6)">
                <img class="thumbnail-img" src="thumbnails/Other360_room_thumbnail.png" alt="Other360/room" width="64">
              </span>
              <span class="pill scene-pill" data-value="Other360_vasedeck"
                onclick="selectCompVideo(activeMethodPill, this, 6)">
                <img class="thumbnail-img" src="thumbnails/Other360_vasedeck_thumbnail.png" alt="Other360/vasedeck"
                  width="64">
              </span>
              <span class="pill scene-pill" data-value="Other360_pinecone"
                onclick="selectCompVideo(activeMethodPill, this, 6)">
                <img class="thumbnail-img" src="thumbnails/Other360_pinecone_thumbnail.png" alt="Other360/pinecone"
                  width="64">
              </span>

            </div>

            <script>
              activeMethodPill = document.querySelector('.method-pill.active-pill');
              activeScenePill = document.querySelector('.scene-pill.active-pill');
              activeModePill = document.querySelector('.mode-pill.active-pill');
              updateMethodVisibility('rgb')
            </script>
          </div>
        </div>
      </div>

      <!-- Quantitative Results. -->
      <!-- <div class="columns is-centered has-text-centered"> -->
      <!-- <div class="column is-full-width"> -->
      <!-- <h2 class="title is-2">Quantitative Results</h2> -->
      <!-- <p class="content has-text-justified"> -->

      <!-- </p> -->
      <!-- <img src="./static/images/quantitative.png" alt="Quantitative" style="width: 100%;" /> -->

      <!-- </div> -->
      <!-- </div> -->
      <!-- Quantitative Results -->

      <!-- Poster -->
      <!-- <div class="columns is-centered"> -->
      <!-- <div class="column is-full-width"> -->
      <!-- <h2 class="title is-2">Poster</h2> -->
      <!-- <embed src="./static/images/AuraPoster.pdf" type="application/pdf" width="100%" height="600px" /> -->
      <!-- </div> -->
      <!-- </div> -->
      <!-- Poster -->

      <!-- Citation -->
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">BibTeX</h2>
          <div
            style="display: inline-block; text-align: left; max-width: 100%; background: #f5f5f5; padding: 10px; border-radius: 5px;">
            <textarea id="bibtex" style="display: none;">
@InProceedings{,
  author    = {},
  title     = {},
  booktitle = {},
  month     = {},
  year      = {},
  pages     = {}
}
</textarea>
          </div>
        </div>
      </div>
      <!-- Citation -->

      <!-- Acknowledgements -->
      <!-- <div class="columns is-centered"> -->
      <!-- <div class="column is-full-width"> -->
      <!-- <h2 class="title is-2">Acknowledgements</h2> -->
      <!-- <div class="content has-text-justified"> -->
      <!-- <p> -->
      <!-- This work was supported by NVIDIA Taiwan AI Research & Development Center (TRDC). -->
      <!-- </p> -->
      <!-- </div> -->
      <!-- </div> -->

    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
        <a class="icon-link" href="">
          <i class="fas fa-file-pdf"></i>
        </a>
        <a class="icon-link" href="" class="external-link" disabled>
          <i class="fab fa-github"></i>
        </a>
      </div>
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              Website template borrowed from <a href="https://nerfies.github.io/">NeRFies</a>, <a
                href="https://dorverbin.github.io/refnerf">Ref-NeRF</a>, <a
                href="https://reconfusion.github.io/">ReconFusion</a> and <a href="https://nesf3d.github.io/">NeSF</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>

</html>