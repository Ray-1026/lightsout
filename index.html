<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="LightsOut: Diffusion-based Outpainting for Enhanced Lens Flare Removal.">
  <meta name="keywords" content="LightsOut, Lens Flare Removal, Outpainting, Diffusion Model">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LightsOut</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- <link rel="stylesheet" href="./static/css/bootstrap.min.css"> -->
  <!-- <link rel="stylesheet" href="./static/css/app.css"> -->
  <link rel="icon" href="./static/images/favicon_new.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="./static/js/video_comparison.js"></script>
  <script src="./static/js/app.js"></script>
</head>

<body>
 <!-- project name , author .... -->
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title neon-text">LightsOut <img src="static/images/favicon_new.svg" alt="icon"
                  style="height: 2.25em; "></h1>
            <h2 class="subtitle is-3 publication-subtitle"><strong>Diffusion-based Outpainting for Enhanced Lens Flare
                Removal</strong></h2>
            <h3 class="subtitle is-3 publication-subtitle"><strong>ICCV 2025</strong></h3>
            <div class="is-size-4 publication-authors">
              <span class="author-block">
                <a href="">Shr-Ruei Tsai</a>,</span>
              <span class="author-block">
                <a href="">Wei-Cheng Chang</a>,</span>
              <span class="author-block">
                <a href="https://jayinnn.dev/">Jie-Ying Lee</a>,</span>
              <span class="author-block">
                <a href="https://su-terry.github.io/">Chih-Hai Su</a>,</span>
              <span class="author-block">
                <a href="https://yulunalexliu.github.io/">Yu-Lun Liu</a></span>
            </div>

            <div class="is-size-4 publication-authors">
              <span class="author-block">National Yang Ming Chiao Tung University</span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <span class="link-block">
                  <a href="" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://github.com/Ray-1026/LightsOut-official"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>



   <!-- teaser . -->
  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <div class="pipeline-figure">
          <img src="./static/images/teaser.png" alt="Teaser" style="width: 100%;" />
        </div>
      </div>
    </div>
  </section>

   <!-- Video. -->
  <section class="section">
    <div class="container is-max-desktop">
      <!-- Video. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Video</h2>
          <div class="video-container"
            style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; border-radius: 12px;">
            <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 12px;" src=""
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Abstract. -->
  <section class="section">
    <div class="container is-max-desktop">
      
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Lens flare significantly degrades image quality, impacting critical computer vision tasks like object
              detection and autonomous driving. Recent Single Image Flare Removal (SIFR) methods perform poorly when
              off-frame light sources are incomplete or absent. We propose LightsOut, a diffusion-based outpainting
              framework tailored to enhance SIFR by reconstructing off-frame light sources. Our method leverages a
              multitask regression module and LoRA fine-tuned diffusion model to ensure realistic and physically
              consistent outpainting results. Comprehensive experiments demonstrate LightsOut consistently boosts the
              performance of existing SIFR methods across challenging scenarios without additional retraining, serving
              as a universally applicable plug-and-play preprocessing solution.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>



  <section class="section">
  <!-- Pipeline Fig. -->
   <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Approach</h2>
          <div class="pipeline-figure">
            <img src="./static/images/pipeline.png" alt="Pipeline" style="width: 95%;" />
          </div>
          <div class="content has-text-justified">
            <p>
              (a) <strong>Light source prediction and conditioning</strong>: We introduce a multitask regression module
              to accurately predict off-frame or incomplete light source parameters (positions, radii, and confidences).
              These predicted parameters guide a rendering function to generate the corresponding light source mask. (b)
              <strong>Light source outpainting</strong>: Leveraging a LoRA fine-tuned diffusion-based inpainting model
              with light source conditioning, our approach accurately outpaints both missing off-frame light sources and
              associated flare artifacts, producing visually coherent and realistic results. (c) <strong>SIFR
                boosting</strong>: Our generated outpainted images serve as enhanced inputs to existing SIFR methods,
              significantly improving their performance on previously challenging scenarios with incomplete light source
              information. The proposed pipeline thus effectively operates as a plug-and-play module to boost existing
              flare removal models.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>




  <section class="section">
    <div class="container is-max-desktop">
      <!-- Animation. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Visualization Results</h2>
          
          <!-- Method Selection Pills -->
          <div class="text-center">
            <ul class="nav nav-pills center-pills">
              <li class="method-pill active" data-value="zhou" onclick="selectComparisonMethod(this)"><a>Zhou, et al</a></li>
              <li class="method-pill" data-value="flare7k" onclick="selectComparisonMethod(this)"><a>Flare7K++</a></li>
              <li class="method-pill" data-value="mfdnet" onclick="selectComparisonMethod(this)"><a>MFDNet</a></li>
            </ul>
          </div>

          <!-- Image Grid with Hover Swap -->
          <div class="comparison-grid" style="margin: 2rem 0;">
            <div class="columns is-centered">
              <div class="column is-4"><div class="hover-swap-container"><img id="comparison-image-1" class="hover-swap-image" /></div></div>
              <div class="column is-4"><div class="hover-swap-container"><img id="comparison-image-2" class="hover-swap-image" /></div></div>
              <div class="column is-4"><div class="hover-swap-container"><img id="comparison-image-3" class="hover-swap-image" /></div></div>
            </div>
            <div class="columns is-centered">
              <div class="column is-4"><div class="hover-swap-container"><img id="comparison-image-4" class="hover-swap-image" /></div></div>
              <div class="column is-4"><div class="hover-swap-container"><img id="comparison-image-5" class="hover-swap-image" /></div></div>
              <div class="column is-4"><div class="hover-swap-container"><img id="comparison-image-6" class="hover-swap-image" /></div></div>
            </div>
          </div>
          <script>
            // method: zhou, flare7k, mfdnet
            const methodFiles = {
              zhou: [
                'res_000000.png', 'res_000002.png', 'res_000004.png', 'res_000009.png', 'res_000037.png', 'res_000096.png'
              ],
              flare7k: [
                'res_000008.png', 'res_000010.png', 'res_000014.png', 'res_000032.png', 'res_000033.png', 'res_000036.png'
              ],
              mfdnet: [
                'res_000018.png', 'res_000034.png', 'res_000050.png', 'res_000052.png', 'res_000074.png', 'res_000095.png'
              ]
            };
            const inputFiles = [
              'output_000000.png', 'output_000002.png', 'output_000004.png', 'output_000009.png', 'output_000037.png', 'output_000096.png',
              'output_000008.png', 'output_000010.png', 'output_000014.png', 'output_000032.png', 'output_000033.png', 'output_000036.png',
              'output_000018.png', 'output_000034.png', 'output_000050.png', 'output_000052.png', 'output_000074.png', 'output_000095.png'
            ];
            
            // 重寫全局的 selectComparisonMethod 函數，確保它不會被 index.js 覆蓋
            window.selectComparisonMethod = function(el) {
              document.querySelectorAll('.method-pill').forEach(pill => pill.classList.remove('active'));
              el.classList.add('active');
              const method = el.getAttribute('data-value');
              const files = methodFiles[method];
              for (let i = 0; i < 6; i++) {
                const img = document.getElementById('comparison-image-' + (i+1));
                // 預設顯示 input 資料夾的照片
                let inputIdx = inputFiles.indexOf('output_' + files[i].replace('res_', ''));
                if (inputIdx === -1) inputIdx = 0;
                img.src = `static/images/flare_remove/input/${inputFiles[inputIdx]}`;
                img.setAttribute('data-hover', `static/images/flare_remove/${method}/${files[i]}`);
                img.setAttribute('data-method', method);
                img.setAttribute('data-idx', i);
                img.alt = `Comparison ${i+1}`;
              }
            };
            
            document.addEventListener('DOMContentLoaded', function() {
              selectComparisonMethod(document.querySelector('.method-pill.active'));
              document.querySelectorAll('.hover-swap-image').forEach(img => {
                img.addEventListener('mouseenter', function() {
                  if (img.getAttribute('data-hover')) img.src = img.getAttribute('data-hover');
                });
                img.addEventListener('mouseleave', function() {
                  // 回到 input 資料夾的照片
                  const method = document.querySelector('.method-pill.active').getAttribute('data-value');
                  const files = methodFiles[method];
                  const idx = parseInt(img.id.split('-')[2], 10) - 1;
                  let inputIdx = inputFiles.indexOf('output_' + files[idx].replace('res_', ''));
                  if (inputIdx === -1) inputIdx = 0;
                  img.src = `static/images/flare_remove/input/${inputFiles[inputIdx]}`;
                  img.setAttribute('data-method', method);
                  img.setAttribute('data-idx', idx);
                });
              });
            });
          </script>
          
          <p class="hover-instruction">Hover over any image to see the comparison results</p>
        </div>
      </div>
      <!--/ Animation. -->

      <div class="columns is-centered">
        <div class="column is-full-width">
          <p class="text-justify" style="text-align: center;">
            Compare our LightsOut method with different baseline approaches. Select a method above and hover over the image to see the before/after comparison.
          </p>
        </div>
      </div>

      <!-- Quantitative Results. -->
      <!-- <div class="columns is-centered has-text-centered"> -->
      <!-- <div class="column is-full-width"> -->
      <!-- <h2 class="title is-2">Quantitative Results</h2> -->
      <!-- <p class="content has-text-justified"> -->

      <!-- </p> -->
      <!-- <img src="./static/images/quantitative.png" alt="Quantitative" style="width: 100%;" /> -->

      <!-- </div> -->
      <!-- </div> -->
      <!-- Quantitative Results -->

      <!-- Poster -->
      <!-- <div class="columns is-centered"> -->
      <!-- <div class="column is-full-width"> -->
      <!-- <h2 class="title is-2">Poster</h2> -->
      <!-- <embed src="./static/images/AuraPoster.pdf" type="application/pdf" width="100%" height="600px" /> -->
      <!-- </div> -->
      <!-- </div> -->
      <!-- Poster -->

      <!-- Outpainting Result -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Outpainting Result</h2>
          <div class="comparison-grid outpainting-section" style="margin: 2rem 0;">
            <div class="columns is-centered">
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000007_1.png" data-hover="./static/images/outpaintresult/result/blend_000007_2.png" alt="Outpainting 1" class="hover-swap-image" />
                </div>
              </div>
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000026_1.png" data-hover="./static/images/outpaintresult/result/blend_000026_2.png" alt="Outpainting 2" class="hover-swap-image" />
                </div>
              </div>
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000044_1.png" data-hover="./static/images/outpaintresult/result/blend_000044_2.png" alt="Outpainting 3" class="hover-swap-image" />
                </div>
              </div>
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000053_1.png" data-hover="./static/images/outpaintresult/result/blend_000053_2.png" alt="Outpainting 4" class="hover-swap-image" />
                </div>
              </div>
            </div>
            <div class="columns is-centered">
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000056_1.png" data-hover="./static/images/outpaintresult/result/blend_000056_2.png" alt="Outpainting 5" class="hover-swap-image" />
                </div>
              </div>
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000066_1.png" data-hover="./static/images/outpaintresult/result/blend_000066_2.png" alt="Outpainting 6" class="hover-swap-image" />
                </div>
              </div>
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000070_1.png" data-hover="./static/images/outpaintresult/result/blend_000070_2.png" alt="Outpainting 7" class="hover-swap-image" />
                </div>
              </div>
              <div class="column is-3">
                <div class="hover-swap-container">
                  <img src="./static/images/outpaintresult/input/output_000083_1.png" data-hover="./static/images/outpaintresult/result/blend_000083_2.png" alt="Outpainting 8" class="hover-swap-image" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 為 Outpainting Result 區域添加 hover 事件處理 -->
      <script>
        document.addEventListener('DOMContentLoaded', function() {
          // 只為 Outpainting Result 區域的圖片添加 hover 事件
          const outpaintingImages = document.querySelectorAll('.outpainting-section .hover-swap-image');
          outpaintingImages.forEach(img => {
            // 存儲原始圖片路徑
            if (!img.dataset.originalSrc) {
              img.dataset.originalSrc = img.src;
            }
            
            const originalSrc = img.dataset.originalSrc;
            const hoverSrc = img.getAttribute('data-hover');
            
            if (hoverSrc) {
              // 移除現有的事件監聽器
              img.onmouseenter = null;
              img.onmouseleave = null;
              
              // 預載入 hover 圖片
              const hoverImage = new Image();
              hoverImage.src = hoverSrc;
              
              // 添加新的事件監聽器
              img.onmouseenter = function() {
                this.src = hoverSrc;
              };
              
              img.onmouseleave = function() {
                this.src = originalSrc;
              };
            }
          });
        });
      </script>
      
      <!-- Citation -->
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">BibTeX</h2>
          <div
            style="display: inline-block; text-align: left; max-width: 100%; background: #f5f5f5; padding: 10px; border-radius: 5px;">
            <textarea id="bibtex" style="display: none;">
            @InProceedings{,
              author    = {},
              title     = {},
              booktitle = {},
              month     = {},
              year      = {},
              pages     = {}
            }
            </textarea>
          </div>
        </div>
      </div>
       <!-- Acknowledgements -->
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-2">Acknowledgements</h2>
          <div class="content has-text-justified">
            <p>
              This research was funded by the National Science and Technology Council, Taiwan, under Grants NSTC
              112-2222-E-A49-004-MY2 and 113-2628-E-A49-023-. The authors are grateful to Google, NVIDIA, and MediaTek
              Inc. for their generous donations. Yu-Lun Liu acknowledges the Yushan Young Fellow Program by the MOE in
              Taiwan.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
        <a class="icon-link" href="">
          <i class="fas fa-file-pdf"></i>
        </a>
        <a class="icon-link" href="" class="external-link" disabled>
          <i class="fab fa-github"></i>
        </a>
      </div>
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              Website template borrowed from <a href="https://nerfies.github.io/">NeRFies</a>, <a
                href="https://dorverbin.github.io/refnerf">Ref-NeRF</a>, <a
                href="https://reconfusion.github.io/">ReconFusion</a> and <a href="https://nesf3d.github.io/">NeSF</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>

</html>